---
title: "Makeup Shades Variability, Price, and Availability  Around the World"
subtitle: "SDS 220 Final Project"
author: 
- name: Katelyn Diaz
  affiliation: Smith College
- name: Sara Gutierrez
  affiliation: Smith College
- name: Allison Wong
  affiliation: Smith College
date: "`r format(Sys.Date(), '%B %e, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    fig_width: 10
    fig_height: 6
    fig_caption: true
    theme: lumen
    df_print: paged
    code_folding: hide
    link-citations: true
references: 
- id: data.world
  type: article
  title: "data.world Diversity of Makeup Shades"
  author: 
  - family: Lee
    given: Jason 
  issued:
    year: 2018
  publisher: Data.World
  url: https://data.world/the-pudding/diversity-of-makeup-shades
editor_options: 
  chunk_output_type: console
---


```{r setup, message = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  echo = TRUE
)
library(tidyverse)
library(openintro)
library(plotly)
library(moderndive)
library(kableExtra)
makeupdata <- read.csv("makeupshades3 copy.csv")
  #"SDS220_FinalProjectPersonalExploration/makeupshades1.csv") <- if i need to run the data
```

```{r filtering out NA in best_seller}
makeup_shades <- makeupdata %>%
  filter(!is.na(best_seller))
```

***
<style>
div.blue { background-color:#f2f1f0; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

  During our data exploration, the question that we were trying to answer was if there is a relationship between price and lightness across different value makeup brands around the world. We did this using the data from `Data.World` and their article [Diversity of Makeup Shades](https://data.world/the-pudding/diversity-of-makeup-shades). After playing around with different variables, we settled on `price` and `lightness`, organized by `best_seller`. More specifically, we all liked the idea of finding a relationship between `price` and `lightness`, because we think price is an important factor in determining the likelihood of someone purchasing a makeup product. Since lightness is a number, we can relate it to the price. We also wanted to use the categorical variable `best_seller`, as it allows us to see shade variability separated into four countries, allowing us to observe the diversity of its products and shades, as well as if there is any correlation with `price`. 
  
  When glimpsing the data, we noticed about ~100 `na`'s under `best_seller`. To make our analysis easier, we filtered out `na`'s from the data set. Our categorical variable is `best_seller`, and our numerical variables are `price` (quantitative response variable) and `lightness`(explanatory variable). 
  
  Many brands only offer lighter shades because they claim that darker shades are “more difficult to create”, but this is a disservice to makeup consumers with a darker complexion.  We wanted to see if there could be any relationship between the specific shade and price (i.e. are darker shades more expensive?), as well as if this differs by location.

</div>

***

  
### Linear Regressions


**Parallel Slopes model**


```{r}
makeup_model <- lm(price ~ lightness + best_seller, data = makeupdata)
summary(makeup_model)
```

```{r}
ggplot(makeup_shades, aes(lightness, price, col = best_seller)) + 
    geom_rect(data=NULL,
             aes(xmin=0,xmax=20,ymin=-Inf,ymax=Inf), 
             fill="#ffdbac", col = "#ffdbac")+
  geom_rect(data=NULL,
            aes(xmin=20,xmax=40,ymin=-Inf,ymax=Inf),
            fill="#f1c27d", col="#f1c27d")+
  geom_rect(data=NULL,
            aes(xmin=40,xmax=60,ymin=-Inf,ymax=Inf),
            fill="#e0ac69", col="#e0ac69")+
  geom_rect(data=NULL,
            aes(xmin=60,xmax=80,ymin=-Inf,ymax=Inf),
            fill="#c68642", col="#c68642")+
  geom_rect(data=NULL,
             aes(xmin=80,xmax=100,ymin=-Inf,ymax=Inf), 
             fill="#8d5524", col="#8d5524")+
  scale_x_continuous(breaks=c(0,20,40,60,80,100))+
 scale_color_manual(values=c("#001eff", #india is first
                             "#4deeea", "#ffe700", "#74ee15", "FFFFFF"))+ # color codes the data
 theme_minimal(base_size=20
               # ,
               # scale_fill_discrete(name = "Country")
            )+ # makes a white background, base size changes font size
  labs(title="Parallel Slopes Model of Makeup Data",
       subtitle="India as the baseline. Looking for correlation between price and lightness\n of foundations across different countries.",
       y= "Price (in US Dollars)",
       x ="Lightness (Lightest to Darkest)") +
  scale_colour_discrete("Best Seller\n by Country") +
  geom_point() +
   geom_parallel_slopes(se=FALSE)
```

price_hat_India = 9.1686 -.007326x (for the baseline, India, x = lightness)

Japan:

price_hat_Japan = (9.16486 + 36.725890) - .007326x

For every one unit increase in lightness, we could expect to see, on average, a price decreases by .007
We did not choose the parallel slopes model because... 


**Interaction model** (baseline = India)

```{r}
makeup_model2 <- lm(price ~ lightness * best_seller, data = makeup_shades)
summarymm <- summary(makeup_model2)
summarymm
#   tidy() %>%
#   kable()
```

```{r linearity plot}
ggplot(makeup_shades, aes(lightness, price, col = best_seller))+
  
   geom_rect(data=NULL,
             aes(xmin=0,xmax=20,ymin=-Inf,ymax=Inf), 
             fill="#ffdbac", col = "#ffdbac")+
  geom_rect(data=NULL,
            aes(xmin=20,xmax=40,ymin=-Inf,ymax=Inf),
            fill="#f1c27d", col="#f1c27d")+
  geom_rect(data=NULL,
            aes(xmin=40,xmax=60,ymin=-Inf,ymax=Inf),
            fill="#e0ac69", col="#e0ac69")+
  geom_rect(data=NULL,
            aes(xmin=60,xmax=80,ymin=-Inf,ymax=Inf),
            fill="#c68642", col="#c68642")+
  geom_rect(data=NULL,
             aes(xmin=80,xmax=100,ymin=-Inf,ymax=Inf), 
             fill="#8d5524", col="#8d5524")+
  geom_point() +
  scale_x_continuous(breaks=c(0,20,40,60,80,100))+
  geom_smooth(method = "lm", se=FALSE) +## lm means line, se = FALSE gets rid of the buffer
 scale_color_manual(values=c("#001eff", #india is first
                             "#4deeea", "#ffe700", "#74ee15", "FFFFFF"))+ # color codes the data
 theme_minimal(base_size=20
               # ,
               # scale_fill_discrete(name = "Country")
            )+ # makes a white background, base size changes font size
  labs(title="Interaction Model of Makeup Data",
       subtitle="India as the baseline. Looking for correlation between price and lightness\n of foundations across different countries.",
       y= "Price (in US Dollars)",
       x ="Lightness (Lightest to Darkest)") +
  scale_colour_discrete("Best Seller\n by Country") 
  
```








**Constant Variance plot**

```{r constant variance plot}
ggplot(data = makeup_model, aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  xlab("Fitted values") +
  ylab("Residuals")
```

***
<style>
div.blue { background-color:#f2f1f0; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Our constant variance plot is not ideal. The fitted values represent the price we expect to see from our linear model using the makeup's lightness while the residuals represent the observed price minus the expected price. Each point is a the expected price and how close it was to the original price in the data. An ideal plot would have residual values within a certain range throughout all fitted values. We would be able to draw a rectangle encompassing all the points. This rectangle would show that across all levels of our expected prices, our residuals stay within a certain range and has constant variance. Ideally, the plot would demonstrate as our expected prices from our model increase, we would expect similar differences in our residuals.

However, from our plot, it is clear that a box would not we suit the points. The points instead fit a more triangular shape with a smaller range of residual values (from -7 to 5) at smaller fitted values around an expected price of 10, but a much larger range (-27 to 23) at larger fitted values around an expected price of 45. Starting at lower fitted values, the range of residuals gradually increases until the highest fitted values at 45. Thus, our constant variance plot demonstrates that as our expected prices from our model increase, we also expect greater differences in our residuals. Our model does not demonstrate constant variance. 

</div>

***

### Residuals 


```{r residuals1}
plot1a <- ggplot(makeup_shades, aes(x = lightness, y = price))+
  geom_point()+
  geom_point(aes(color=best_seller))+
  geom_smooth(method = "lm", se = FALSE) # drawing the regression line
#plot1a
#ggplotly(plot1a)
# Summary statistics
question1a <- lm(price ~ lightness, data = makeup_shades)
ggplot(data = question1a, aes(x = .resid)) +
  geom_histogram() +
  xlab("Residuals")
```

***
<style>
div.blue { background-color:#f2f1f0; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

The residuals histogram can be used to determine if variance is normally distributed. Based on this histogram, it appears that the histogram is right skewed, meaning that they are not normally distributed. This means that we can't trust the p-values on the summary table. 

</div>

***

### Limitations and Conclusion

***
<style>
div.blue { background-color:#f2f1f0; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

  Based on our 

</div>

***

...
### Appendix

***
<style>
div.blue { background-color:#f2f1f0; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

For our interaction model, the baseline, India, was represented by the equation: **price_hat_India = 4.1129345 + 0.0607310x**, in which x equals the "lightness" variable. For every 1 unit increase in lightness, we expect to see, on average, an increase of price by $0.06 (the slope), and  when the lightness is equal to zero (the intercept and lightest possible shade) we expect the price to be, on average, $4.11. 


Besides from our baseline, we also looked at data for makeup bestsellers in Japan. This was represented by the equation: **price_hat_Japan = (4.11 + 36.55) + (0.0607310 - 0.0001561)x**. On average, we can expect to see that for every unit increase in lightness, there is an increase in price by $(0.0607310 - 0.0001561), or approximately $0.06. When the lightness is equal to zero, we expect to see the price to be, on average, $(4.11 + 36.55), or $40.66. Even though the slope of the baseline and the slope of **price_hat_Japan** are very similar, Japan starts off at a much higher price. This leads us to believe that from the start, the cost of makeup best sellers in Japan is much more expensive than the cost in India. 


Nigeria on the other hand does not appear to show behavior as drastic as Japan. The regression line for Nigeria is represented by **price_hat_Nigeria = (4.11 + 12.64) + (0.0607310 - 0.0626467)x**, where for every one unit increase in lightness, we expect the price to *decrease* by $(0.0607310 - 0.0626467), or $0.0019 on average. This value clearly doesn't even equal one cent, so the slope of **price_hat_Nigeria** is roughly the same as the baseline. When the lightness is equal to zero, we expect the price to be (4.11 + 12.64), or $16.75 on average. While this price might not be as expensive as the price in Japan, it is still a bit more than the baseline. 


Lastly, we looked at the data for makeup bestsellers in the U.S. The regression line for the U.S. is represented by **price_hat_US = (4.11 + 21.73) + (0.0607310 - 0.0851736)x**. We expect the price to decrease, on average, by $(0.0607310 - 0.0851736) or approximately $0.03 for every one unit increase in lightness. When the lightness is equal to zero, the price is expected to be $(4.11 + 21.73) or $25.84 on average. Compared to the baseline, the price of makeup best sellers in the U.S. are still more expensive to those in India. 


From this analysis, we can see that the price of makeup best sellers in India is the cheapest at $4.11, compared to the other countries which have much higher prices. Japan being the most expensive at $40.66, then the U.S. at $25.84, and finally Nigeria at $16.75. From the slopes, we can see that in Japan and India, there is a positive correlation between price and lightness, and then in Nigeria and the U.S., a negative correlation between the two. 

</div>

***

### References

